---
id: 2
title: 2.纠缠鲁棒性
sidebar_position: 2
---

# 四量子比特纠缠检测蒙特卡洛优化代码文档

## 一、项目概述

本代码基于**四量子比特系统**，针对 **"22划分"** 场景下的纠缠检测进行蒙特卡洛优化。主要目标是计算给定混合态（GHZ态与Dicke态混合）的**纠缠鲁棒性（robustness）**，并通过优化一组参数 `M_i` 来提高检测精度。

---

## 二、核心变量定义

### 1. 基础矩阵
- **Dicke态密度矩阵**：`dicke` (16×16)，描述特定对称态
- **GHZ态密度矩阵**：`ghz` (16×16)，标准GHZ态
- **泡利矩阵**：
  ```matlab
  s0 = [1 0; 0 1]      % 单位矩阵
  s1 = [0 1; 1 0]      % X
  s2 = [0 -1i; 1i 0]   % Y
  s3 = [1 0; 0 -1]     % Z
  ```

### 2. 主要参数
- **混合角度**：`theta`（65°-75°扫描）
- **优化参数**：`M_re` (14维向量)，存储不同角度下的最优 `M_i` 参数
- **结果存储**：
  - `R_re`：鲁棒性值
  - `c_re`：最优角度参数 (θ₁, θ₂, θ₃)
  - `e_re`：最大本征值
  - `x, y`：归一化的Dicke和GHZ系数

---

## 三、算法流程

### 1. 初始化
- 加载历史优化结果 (`result_gdg22_4bitomgc.mat`)
- 定义Dicke和GHZ态矩阵

### 2. 主循环（角度扫描）
```matlab
for index = 65:1:75
    xita = index * 1/180 * pi;  % 转换为弧度
    rho = (ghz*sin(xita) + dicke*cos(xita));  % 构造混合态
```

### 3. 两级优化策略

#### **第一级优化**（已跳过）
- 使用历史最优参数 `M_re(flag,:)` 作为初始值
- `flag = index + 1` 对应角度索引

#### **第二级优化**（蒙特卡洛细调）
```matlab
for k = 3:2:15  % 缩放因子循环
    for i = 1:10000/k  % 蒙特卡洛迭代
        % 1. 生成随机扰动
        A_M = (2*rand(1,14)-1) / 2^k;
        
        % 2. 更新参数并归一化
        M_new = M_max + A_M;
        M_new = M_new / max(abs(M_new));
        
        % 3. 计算鲁棒性
        [r, c1, c2, c3, e] = robustness(M_new, rho);
        
        % 4. 更新最优值
        if r > maxrobust
            maxrobust = r;
            M_max = M_new;
            th1 = c1; th2 = c2; th3 = c3;
            maxe = e;
        end
    end
end
```

### 4. 结果更新条件
```matlab
if maxrobust - R_re(:,flag) > 0  % 仅当改进时才更新
    % 保存所有相关结果
    c_re(1,flag) = th1;
    c_re(2,flag) = th2;
    c_re(3,flag) = th3;
    e_re(:,flag) = maxe;
    M_re(flag,:) = M_max;
    R_re(:,flag) = maxrobust;
    x(:,flag) = cos(xita)/maxrobust;
    y(:,flag) = sin(xita)/maxrobust;
end
```

---

## 四、关键函数：`robustness`

### 功能
计算给定参数 `M_i` 下的纠缠鲁棒性

### 输入
- `m1` 到 `m14`：14个优化参数
- `rho`：目标密度矩阵（16×16）

### 输出
- `r`：鲁棒性值
- `theta1, theta2, theta3`：最优角度参数
- `ei`：最大本征值

### 算法步骤

#### 1. 构造观测算符 `omg1`
使用14个 `M_i` 参数构造16×16的厄米算符：
```matlab
omg1 = m1*kron(s0,kron(s0,kron(s0,s0)))...
     + m2*(kron(s0,kron(s3,kron(s0,s0))) + ... )...
     + ... % 共14项
```

**参数对应关系**：
- `m1`：I⊗I⊗I⊗I
- `m2`：涉及σ_z的单项项
- `m3, m4`：涉及σ_x, σ_y的双粒子关联
- `m5-m14`：更高阶关联项

#### 2. 正定性检查
```matlab
if min(eig(omg1)) > 0  % 仅当观测算符正定时继续
```

#### 3. 暴力搜索最优测量角度
```matlab
for c1 = 0:time11:180      % θ₁
    for c2 = 0:time12:180  % θ₂
        for c3 = 0:time13:180  % θ₃
            % 构造两比特态 |ψ₁₂⟩
            x0 = cos(θ₁)*cos(θ₂)
            x1 = cos(θ₁)*sin(θ₂)
            x2 = sin(θ₁)*sin(θ₃)
            x3 = sin(θ₁)*cos(θ₃)
            
            % 计算约化矩阵元 r_ij = ⟨ψ|σ_i⊗σ_j|ψ⟩
            % 构造约化观测算符 omg3
            % 计算最大本征值
        end
    end
end
```

#### 4. 鲁棒性计算
```matlab
r = trace(rho * omg1) / maxt
```
其中 `maxt` 是 `omg3` 的最大本征值

---

## 五、核心数学原理

### 1. 观测算符结构
观测算符 `Ω` 写为泡利算符的线性组合：
```
Ω = Σ_i m_i * O_i
```
其中 `O_i` 是特定的泡利串，保证 `Ω ≥ 0`。

### 2. 纠缠见证形式
对于两体划分(1,2|3,4)，见证算符为：
```
W = Ω - t·I
```
鲁棒性定义为：
```
R(ρ) = max{t ≥ 0 | ρ - t·σ ≥ 0, σ ∈ SEP}
```

### 3. 优化问题
```
maximize  Tr(ρΩ)
subject to  max_{|ψ⟩∈SEP} ⟨ψ|Ω|ψ⟩ ≤ 1
```
等价于：
```
R = Tr(ρΩ) / max_{|ψ⟩∈SEP} ⟨ψ|Ω|ψ⟩
```

---

## 六、参数说明

### 时间步长
- `time11 = 5`：θ₁ 搜索步长（度）
- `time12 = 5`：θ₂ 搜索步长
- `time13 = 15`：θ₃ 搜索步长

### 蒙特卡洛参数
- `k = 3:2:15`：扰动缩放因子
- `10000/k`：每个缩放因子的迭代次数

---

## 七、输出结果

### 保存的数据文件
`result_gdg22_4bitomgc.mat` 包含：
- `x, y`：归一化坐标
- `M_re`：各角度最优参数（75×14矩阵）
- `R_re`：鲁棒性值
- `c_re`：最优测量角度
- `e_re`：最大本征值

---

## 八、应用场景

本代码用于：
1. **纠缠检测**：判断混合态是否纠缠
2. **见证优化**：寻找最优纠缠见证算符
3. **鲁棒性量化**：计算态对噪声的容忍度

特别适用于GHZ态与Dicke态混合的四量子比特系统。
